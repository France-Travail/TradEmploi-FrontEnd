<div class="wrapper">
  <div class="header">
    <div class="flags">
      <span class="fi fi-fr"></span>
      <img class="arrow-icon" src="./assets/icons/icon-arrow-right.svg" />
      <span *ngIf="this.targetCountry !== 'xa'" class="fi fi-{{ this.targetCountry }}"></span>
      <img *ngIf="this.targetCountry === 'xa'" class="fi" src="../../../../../assets/images/common/arab-flag.png" alt="flag" />
    </div>
    <button class="end-btn" (click)="evaluate()">TERMINER LA TRADUCTION</button>
  </div>
  <div class="container">
    <p class="title">1 - Déposer le fichier</p>
    <form class="tradtondoc" [formGroup]="ocrForm" (ngSubmit)="onSubmit()">
      <div class="drop-container" (fileDropped)="onFileDropped($event)" DragAndDropDirective>
        <input type="file" #fileDropRef id="fileDropRef" accept="image/png, image/jpeg, image/jpg ,application/pdf" (change)="fileBrowseHandler($event)" />
        <div class="file-input-container">
          <label class="end-btn upload-btn" for="fileDropRef">
            <img class="cross-icon" src="./assets/icons/icon-cross.svg" alt="cross icon" />
            Nouveau fichier
          </label>
          <p class="text-selected-file">{{ file ? fileName : 'Aucun fichier sélectionné' }}</p>
        </div>
        <div class="text-controls">
          <span>Formats acceptés : PDF (1 seule page), JPG, JPEG, PNG</span>
          <p>Taille maximum : 10 Mo</p>
          <p>Nombre de caractères max. : 10 000 caractères</p>
        </div>
      </div>
      <div class="presentation">
        <div class="vizualisation" *ngIf="!this.isPdf && this.isConform">
          <p class="title"><span class="fi fi-fr"></span> 2 - Sélectionner la zone à traduire</p>

          <image-cropper
            [imageChangedEvent]="imageChangedEvent"
            [aspectRatio]="1"
            [resizeToWidth]="512"
            [maintainAspectRatio]="false"
            format="png"
            (imageCropped)="imageCropped($event)"
          ></image-cropper>

          <button class="end-btn submit-btn" type="submit" *ngIf="isConform">Lancer la détection du texte et la traduction</button>
        </div>
        <div class="translation" *ngIf="translatedText">
          <p class="title">
            <span *ngIf="this.targetCountry !== 'xa'" class="fi fi-{{ this.targetCountry }}"></span>
            <img *ngIf="this.targetCountry === 'xa'" class="fi" src="../../../../../assets/images/common/arab-flag.png" alt="flag" />
            3 - Lire le texte traduit
          </p>
          <div class="text-translated-area">
            <div class="text-container">
              <div *ngIf="translatedText && translatedText.length > 0">
                {{ translatedText }}
              </div>
            </div>
          </div>
          <div class="audio-controls">
            <button *ngIf="showAudioControls" class="end-btn listening-btn" type="button" (click)="isPlaying ? pause() : resume()">
              <mat-icon>{{ isPlaying ? 'pause' : 'play_arrow' }}</mat-icon>
              Lire vocalement
            </button>
            <app-loader *ngIf="!showAudioControls"></app-loader>
          </div>
        </div>
      </div>
    </form>
  </div>
</div>
